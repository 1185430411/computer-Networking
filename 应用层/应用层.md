### 目录
#### 一.文件传送协议FTP
#### 二·动态主机配置协议DHCP
#### 三.电子邮件协议
 ##### 1.SMTP
 ##### 2.POP3
 ##### 3.IMAP
 ##### 4.MIME
#### 四.常用端口
#### 五.Web网页请求过程
 ##### 1.DHCP配置主机信息
 ##### 2.ARP解析域名地址
 ##### 3.DNS解析域名
 ##### 4.HTTP请求页面
 
 ————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————、
 
 # 一.文件传送协议FTP
 FTP采用TCP进行连接，需要两个连接来传输一个文件：
 1.控制连接：服务器打开端口号21等待客户端的连接，客户端连接后，利用这个连接将客户端的命令传给服务器，并传回服务器的回应。
 2.数据连接：用来传送一个数据文件
 而根据数据连接是否是服务器主动连接的，FTP的连接分为主动连接和被动连接
 1.主动连接：服务器主动请求建立数据连接，且端口号为20，客户端的端口号随机，但必须大于1024，因为1-1023是熟知端口号。
 2.被动连接：客户端主动请求建立数据连接，客户端的端口号由主机选定，而服务器端口号随机。
 
 主动模式要求客户端开放端口号给服务器，而且需要配置客户端的防火墙。被动模式只需要服务器打开端口即可，无需配置防火墙，但这样的安全性较弱。
 
 # 二.动态主机配置协议DHCP
 DHCP提供了即插即连的方式，用户无需手动去配置IP信息。
 DHCP不仅配置IP地址，还包括子网掩码和网关IP地址。
 DHCP工作过程如下：
 1.主机发送一个“Discover”报文，被放入UDP中，该报文被广播到同一个子网的所有主机，但只有DHCP服务器能响应，若DHCP与主机不在一个子网内，就需要使用中继代理。
 2.DHCP收到报文后，给主机发回一个“Offer”报文，其中包含了主机希望知道的信息。另外主机可能接到多个DHCP服务器发来的报文，主机需要进行筛选。
 3.客户端收到了DHCP的报文，再给DHCP报文发送“Request”报文，请求使用DHCP提供的信息。
 4.DHCP检查得知主机没有IP地址后，发送ACK同意主机使用。
 
 # 三.电子邮件协议
 电子邮件协议包括 发送协议 和 读取协议。其中发送协议常用SMTP，读取协议常用POP3和IMAP。
 ## 1.SMTP
 SMTP是邮件发送使用的协议，它只能发送ASCLL码。
 
 ## 2.POP3
 邮件读取协议。特点是只要用户从服务器上读取了邮件，就把该邮件删除
 
 ## 3.IMAP
 IMAP让客户端和服务器上的邮件保持一致，如果不动手删除邮件，服务器上的邮件也不会被删除，使用户可以随时访问服务器上的邮件。
 
 ## 4.MIME
 把非ASCLL码转换为ASCLL码（如中文等非英文数据）。MIME协议并不是改动或者取代SMTP协议，而只是增加了邮件主体的结构，定义了非ASCLL码的编码规则。
 
 # 四.常用端口
 
 应用	         应用层协议	    端口号	   传输层协议	      备注
域名解析	        DNS	           53	     UDP/TCP	 长度超过 512 字节时使用 TCP
动态主机配置协议  DHCP	         67/68	    UDP	
简单网络管理协议	SNMP	         161/162	  UDP	
文件传送协议	    FTP	           20/21	    TCP	      控制连接 21，数据连接 20
远程终端协议	    TELNET	        23	      TCP	
超文本传送协议	   HTTP	           80	        TCP	
简单邮件传送协议	SMTP	          25	       TCP	
邮件读取协议	    POP3	          110	       TCP	
网际报文存取协议	IMAP	          143	        TCP	

# 五.Web页面请求过程

## 1.DHCP配置主机信息
以上DHCP协议时已讨论过

## 2.ARP解析MAC地址
1.主机通过浏览器生成一个 TCP 套接字，套接字向 HTTP 服务器发送 HTTP 请求。为了生成该套接字，主机需要知道网站的域名对应的 IP 地址。

2.主机生成一个 DNS 查询报文，该报文具有 53 号端口，因为 DNS 服务器的端口号是 53。

3.该 DNS 查询报文被放入目的地址为 DNS 服务器 IP 地址的 IP 数据报中。

4.该 IP 数据报被放入一个以太网帧中，该帧将发送到网关路由器。

5.DHCP 过程只知道网关路由器的 IP 地址，为了获取网关路由器的 MAC 地址，需要使用 ARP 协议。

6.主机生成一个包含目的地址为网关路由器 IP 地址的 ARP 查询报文，将该 ARP 查询报文放入一个具有广播目的地址（FF:FF:FF:FF:FF:FF）的以太网帧中，并向交换机发送该以太网帧，交换机将该帧转发给所有的连接设备，包括网关路由器。

7.网关路由器接收到该帧后，不断向上分解得到 ARP 报文，发现其中的 IP 地址与其接口的 IP 地址匹配，因此就发送一个 ARP 回答报文，包含了它的 MAC 地址，发回给主机
 
## 3.DNS解析域名
1.知道了网关路由器的 MAC 地址之后，就可以继续 DNS 的解析过程了。

2.网关路由器接收到包含 DNS 查询报文的以太网帧后，抽取出 IP 数据报，并根据转发表决定该 IP 数据报应该转发的路由器。

3.因为路由器具有内部网关协议（RIP、OSPF）和外部网关协议（BGP）这两种路由选择协议，因此路由表中已经配置了网关路由器到达 DNS 服务器的路由表项。

4.到达 DNS 服务器之后，DNS 服务器抽取出 DNS 查询报文，并在 DNS 数据库中查找待解析的域名。

5.找到 DNS 记录之后，发送 DNS 回答报文，将该回答报文放入 UDP 报文段中，然后放入 IP 数据报中，通过路由器反向转发回网关路由器，并经过以太网交换机到达主机。

## 4.HTTP请求页面
1.有了 HTTP 服务器的 IP 地址之后，主机就能够生成 TCP 套接字，该套接字将用于向 Web 服务器发送 HTTP GET 报文。

2.在生成 TCP 套接字之前，必须先与 HTTP 服务器进行三次握手来建立连接。生成一个具有目的端口 80 的 TCP SYN 报文段，并向 HTTP 服务器发送该报文段。

3.HTTP 服务器收到该报文段之后，生成 TCP SYN ACK 报文段，发回给主机。

4.连接建立之后，浏览器生成 HTTP GET 报文，并交付给 HTTP 服务器。

5.HTTP 服务器从 TCP 套接字读取 HTTP GET 报文，生成一个 HTTP 响应报文，将 Web 页面内容放入报文主体中，发回给主机。

6.浏览器收到 HTTP 响应报文后，抽取出 Web 页面内容，之后进行渲染，显示 Web 页面。
 
 
 
 
 
 
 
